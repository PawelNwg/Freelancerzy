
@{
    ViewData["Title"] = "Search";
}

<section class="front">
    <div id="header">
        <h1>Wyszukaj Zlececnia</h1>
        <br />
    </div>
    <div id="filtr">
        <input id="phrase" style="padding:3px; width:30%" placeholder="Wpisz frazę">
        <button id="searchBtn" type="button" style="padding:7px 20px;" class="btn btn-outline-primary btn-dark text-light">Szukaj</button>
    </div>
    <div id="nav">
        <h3>Kategoria</h3>
        <select>
            <option>Programista</option>
            <option>Projektant Wnętrz</option>
            <option>Architekt</option>
            <option>Grafik</option>
            <option>Montarzysta</option>
            <option>Reszta</option>
        </select>
        <br><br />
        <h3>Filtry:</h3>
        <input type="checkbox" name="check1" />
        <label for="check1">coś tam</label><br />
        <input type="checkbox" name="check3" />
        <label for="check2">coś tam</label><br />
        <button type="button" style="padding:7px 15px;" class="btn btn-outline-primary btn-dark text-light">Zastosuj</button>
    </div>
    <div id="content">
        <label>Sortuj według:</label>
        <select id="sort" >
            <option value="nameAsc">Nazwa: A-Z</option>
            <option value="nameDesc">Nazwa: Z-A</option>
            <option value="wageAsc">Stawka: od najniższej</option>
            <option value="wageDesc">Stawka: od najwyższej</option>
            <option value="dateDesc">Data dodania: od najnowszych</option>
            <option value="dateAsc">Data dodania: od najstarszych</option>
        </select>
        <br><br />
        <h3>Oferty:</h3>
        <div id="loader">

        </div>
        <div id="offers">


        </div>

    </div>
</section>

<style>

    .loader {
        margin: auto;
        
        border: 16px solid #f3f3f3; /* Light grey */
        border-top: 16px solid #383838; 
        border-radius: 50%;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
    }

    @@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
    }

    div.offer:hover {
        background-color: dimgray;
    }

    #header {
        text-align: center;
        padding: 20px;
    }

    #filtr {
        text-align: center;
        padding: 20px;
    }

    .border {
        border-width: 10px !important;
    }

    #nav {
        width: 20%;
        padding: 20px;
        text-align: center;
        float: left;
        min-height: 700px;
    }

    #content {

        width: 75%;
        min-height: 800px;
        float: left;
        padding: 20px;
        background-color: lightgray;
        margin-right: 5%;
        margin-bottom: 516px;
    }
</style>
@section Scripts
{
    <script>
        $(function() {
            var pageId = 1;
            var sortorder = $('#sort').val();
            

            var loadTable = function (pageId) {
                $('#offers').empty();
                $('#loader').addClass("loader");

                var searchvalue = $('#phrase').val().replaceAll(' ', '+');
                
                
                var searchstring = searchvalue == '' ? '' : '&searchString=' + searchvalue ;

                

                $('#offers').load('/Offers/OfferListPartial?pageNumber=' + pageId + '&order=' + sortorder + searchstring, null, function () {
                    $('#loader').removeClass("loader");
                   
                });
                
                
            }

            loadTable(pageId);

            $(document).on('click', '#goToPage', null, function () {
                var pageNr = $('#page').val();
                
                if (pageNr <= 0) pageId = 1;
                else if (pageNr > totalPages) pageId = totalPages;
                else pageId = pageNr;
                
                loadTable(pageId);
            })

            $(document).on('click', '#searchBtn', function () { loadTable(pageId) });

            $(document).on('click', '#next', null, function () { loadTable(++pageId); });

            $(document).on('click', '#prev', null, function () { loadTable(--pageId); });

            $(document).on('change', '#sort', null, function () {
                sortorder = $('#sort').val();
                pageId = 1;
                loadTable(pageId)
            })
        });
    </script>
}