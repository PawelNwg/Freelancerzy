-- SQLINES DEMO *** le SQL Developer Data Modeler 19.2.0.182.1216
-- SQLINES DEMO *** -11-07 11:46:37 CET
-- SQLINES DEMO *** Server 2012
-- SQLINES DEMO *** Server 2012



CREATE TABLE category 
    ( categoryid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     CategoryName VARCHAR (30) NOT null ); 

ALTER TABLE Category ADD constraint category_pk PRIMARY KEY (CategoryId)
    ;  

CREATE TABLE credentials (
    userid     NUMERIC(28) NOT NULL,
    password   VARCHAR(200) NOT NULL
);


    


CREATE unique nonclustered index credentials__idx ON credentials ( userid ) go

ALTER TABLE Credentials ADD constraint credentials_pk PRIMARY KEY (UserId)
    ;  

CREATE TABLE message 
    ( messageid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     UserFromId NUMERIC (28) NOT NULL , 
     UserToId NUMERIC (28) NOT NULL , 
     Date DATETIME(3) NOT NULL , 
     Content VARCHAR (250) NOT NULL , 
     Status VARCHAR (20) NOT null ); 

ALTER TABLE Message ADD constraint message_pk PRIMARY KEY (MessageId)
    ;  

CREATE TABLE messagereport 
    ( reportid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     MessageId NUMERIC (28) NOT NULL , 
     ReasonId NUMERIC (28) NOT null ); 

ALTER TABLE MessageReport ADD constraint messagereport_pk PRIMARY KEY (ReportId)
    ;  

CREATE TABLE offer 
    ( offerid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     UserId NUMERIC (28) NOT NULL , 
     CategoryId NUMERIC (28) NOT NULL , 
     Title VARCHAR (40) NOT NULL , 
     Description VARCHAR (250) , 
     CreationDate DATETIME(3) NOT NULL , 
     LastModificationDate DATETIME(3) , 
     ExpirationDate DATETIME(3) NOT NULL , 
     ViewCounter NUMERIC (28) NOT null, wage DECIMAL(28) 
    ); 

ALTER TABLE Offer ADD constraint offer_pk PRIMARY KEY (OfferId)
    ;  

CREATE TABLE permission 
    ( permissionid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     Name VARCHAR (25) NOT null ); 

ALTER TABLE Permission ADD constraint permission_pk PRIMARY KEY (PermissionId)
    ;  

CREATE TABLE permissionuser (
    userid         NUMERIC(28) NOT NULL,
    permissionid   NUMERIC(28) NOT NULL
);


ALTER TABLE PermissionUser ADD constraint permissionuser_pk PRIMARY KEY (UserId, PermissionId)
    ;  

CREATE TABLE reason 
    ( reasonid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     Name VARCHAR (20) NOT
    null,
    description VARCHAR ( 150 )
);

ALTER TABLE Reason ADD constraint reason_pk PRIMARY KEY (ReasonId)
    ;  

CREATE TABLE "User" 
    ( userid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     TypeId NUMERIC (28) NOT NULL , 
     FirstName VARCHAR (20) NOT NULL , 
     Surname VARCHAR (30) NOT NULL , 
     EmailAddress VARCHAR (40) NOT null, phonenumber NUMERIC(28) 
    ); 

ALTER TABLE `User` ADD constraint user_pk PRIMARY KEY (UserId)
     ;
 
ALTER TABLE `User` add constraint user__unv2 unique ( emailaddress );  

CREATE TABLE useraddress 
    (
    userid   NUMERIC(28) NOT NULL,
    street   VARCHAR(30) NOT NULL, 
     Number NUMERIC (28) NOT NULL , 
     ApartmentNumber NUMERIC (28) , 
     ZipCode VARCHAR (6) , 
     City VARCHAR (30) NOT NULL 
    );

    


CREATE unique nonclustered index useraddress__idx ON useraddress ( userid ) go

ALTER TABLE UserAddress ADD constraint useraddress_pk PRIMARY KEY (UserId)
    ;  

CREATE TABLE usertype 
    ( typeid NUMERIC(28) NOT NULL AUTO_INCREMENT NOT FOR REPLICATION , 
     Name VARCHAR (20) NOT null ); 

ALTER TABLE UserType ADD constraint usertype_pk PRIMARY KEY (TypeId)
    ;  

ALTER TABLE Credentials ADD CONSTRAINT credentials_user_fk FOREIGN KEY ( userid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE CASCADE 
    ON UPDATE no action go

ALTER TABLE Message ADD CONSTRAINT message_user_fk FOREIGN KEY ( userfromid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE NO ACTION 
    ON UPDATE no action go

ALTER TABLE Message ADD CONSTRAINT message_user_fkv2 FOREIGN KEY ( usertoid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE NO ACTION 
    ON UPDATE no action go

ALTER TABLE MessageReport
    ADD CONSTRAINT messagereport_message_fk FOREIGN KEY ( messageid )
        REFERENCES message ( messageid )
ON DELETE NO ACTION 
    ON UPDATE no action;  

ALTER TABLE MessageReport
    ADD CONSTRAINT messagereport_reason_fk FOREIGN KEY ( reasonid )
        REFERENCES reason ( reasonid )
ON DELETE NO ACTION 
    ON UPDATE no action;  

ALTER TABLE Offer
    ADD CONSTRAINT offer_category_fk FOREIGN KEY ( categoryid )
        REFERENCES category ( categoryid )
ON DELETE NO ACTION 
    ON UPDATE no action;  

ALTER TABLE Offer ADD CONSTRAINT offer_user_fk FOREIGN KEY ( userid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE CASCADE 
    ON UPDATE no action go

ALTER TABLE PermissionUser
    ADD CONSTRAINT permissionuser_permission_fk FOREIGN KEY ( permissionid )
        REFERENCES permission ( permissionid )
ON DELETE NO ACTION 
    ON UPDATE no action;  

ALTER TABLE PermissionUser ADD CONSTRAINT permissionuser_user_fk FOREIGN KEY ( userid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE NO ACTION 
    ON UPDATE no action go

ALTER TABLE `User`
    ADD CONSTRAINT user_usertype_fk FOREIGN KEY ( typeid )
        REFERENCES usertype ( typeid )
ON DELETE NO ACTION 
    ON UPDATE no action;  

ALTER TABLE UserAddress ADD CONSTRAINT useraddress_user_fk FOREIGN KEY ( userid )
    REFERENCES ""User()"" 
    ( 
     UserId 
    ) 
    ON DELETE CASCADE 
    ON UPDATE no action go



-- SQLINES DEMO *** per Data Modeler Summary Report: 
-- 
-- SQLINES DEMO ***                        11
-- SQLINES DEMO ***                         2
-- SQLINES DEMO ***                        23
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO *** DY                      0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO *** IEW                     0
-- SQLINES DEMO *** EGMENT                  0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
-- SQLINES DEMO *** FUNCTION                0
-- SQLINES DEMO *** SCHEME                  0
-- 
-- SQLINES DEMO ***                         0
-- 
-- SQLINES DEMO ***                         0
-- SQLINES DEMO ***                         0
